launch-templates:
  linux-large:
    resource-class: 'docker_linux_amd64/large'
    image: 'ubuntu22.04-node20.19-v3'
    env:
      GIT_AUTHOR_EMAIL: test@test.com
      GIT_AUTHOR_NAME: Test
      GIT_COMMITTER_EMAIL: test@test.com
      GIT_COMMITTER_NAME: Test
      NX_VERBOSE_LOGGING: true
    init-steps:
      - name: Checkout
        uses: 'nrwl/nx-cloud-workflows/v5/workflow-steps/checkout/main.yaml'

      - name: Check Node Version
        script: node --version

      - name: Install zip and unzip
        script: sudo apt-get -yqq install zip unzip

      - name: Install e2e deps
        script: |
          sudo apt-get update
          sudo apt-get install -y ca-certificates lsof libvips-dev libglib2.0-dev libgirepository1.0-dev

      - name: Calculate Project Graph
        script: |
          ./nx show projects

      - name: Setup Java 21
        script: |
          sudo apt update
          sudo apt install -y openjdk-21-jdk
          sudo update-alternatives --set java /usr/lib/jvm/java-21-openjdk-amd64/bin/java
          java -version
